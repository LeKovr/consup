# -------------------------------------------------------------------------------
#  Consup images config filee

# -------------------------------------------------------------------------------
base:
  build: Dockerfiles/base
#  image: lekovr/consup_base

# -------------------------------------------------------------------------------
master:
  hostname: master
  build: Dockerfiles/master
#  image: lekovr/consup_master
  volumes:
  - /var/cache/apt-cacher-ng:/var/cache/apt-cacher-ng
  - var/log/master:/var/log/supervisor

# -------------------------------------------------------------------------------
baseapp:
  build: Dockerfiles/baseapp
#  image: lekovr/consup_baseapp
  links:
   - master:master

# -------------------------------------------------------------------------------
postgres:
  hostname: db
  build: Dockerfiles/postgres
#  image: lekovr/consup_postgres
  links:
   - master:master
  volumes:
  - app/db:/var/lib/postgresql
  - var/log/db:/var/log/supervisor
  environment:
  - LOCALE=ru_RU
  - TZ=Europe/Moscow

# -------------------------------------------------------------------------------
nginx:
  hostname: nginx
  build: Dockerfiles/nginx
#  image: lekovr/consup_nginx
  links:
   - master:master
  volumes:
  - var/log/nginx:/var/log/supervisor
  - app/nginx:/home/app

# -------------------------------------------------------------------------------
app:
  hostname: app
  build: Dockerfiles/app
#  image: lekovr/consup_app
  links:
   - master:master
   - postgres:db
  volumes:
  - var/log/app:/var/log/supervisor
  - app/eg:/home/app
  environment:
  - PGHOST=db

# -------------------------------------------------------------------------------
dmp:
  hostname: dmp
  build: Dockerfiles/app
#  image: lekovr/consup_app
  links:
   - master:master
   - postgres:db
  volumes:
  - var/log/dmp:/var/log/supervisor
  - app/dmp:/home/app
  environment:
  - PGHOST=db

# -------------------------------------------------------------------------------
pgws:
  hostname: pgws
  build: Dockerfiles/pgws
#  image: lekovr/consup_app
  links:
   - master:master
   - postgres:db
  volumes:
  - var/log/pgws:/var/log/supervisor
  - app/pgws:/home/app
  environment:
  - PGHOST=db
  - APPUSER=op

# -------------------------------------------------------------------------------
modperl:
  hostname: modperl
  build: Dockerfiles
#  image: lekovr/consup_modperl
  links:
   - master:master
   - postgres:db
  volumes:
  - var/log/tpro:/var/log/supervisor
  - app/tpro:/home/app
  environment:
  - PGHOST=db
  - APPUSER=op
