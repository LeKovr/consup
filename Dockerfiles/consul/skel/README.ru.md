# Интерфейс к consul

Пример контейнера, позволяющего развернуть [consul-ui](https://www.consul.io/intro/getting-started/ui.html) в инфраструктуре consup.
Это отдельный контейнер, который расширяет [consup_baseapp](../../baseapp) и использует контейнер consul как зависимость.
Отдельный контейнер, в котором consup-ui выгружен в файл, нужен для того, чтобы можно было отредактировать заголовок в index.html,
добавив туда имя сервера.

## Установка

```
$ docker pull lekovr/consup_consul
$ mkdir consul-ui && cd consul-ui
$ docker run --rm lekovr/consup_consul tar -c -C /skel . | tar x
$ make deps
```

## Настройка

Контейнер не требует настройки, адрес и порт сервиса заданы в fidm.yml

## Использование

```
make start
```

После запуска consul-ui будет доступен по адресу http://127.0.1.2:8500.
Из других контейнеров этот сервис доступен по имени `consul-ui.internal.service.consul` (если контейнер использует consul DNS).

Удаленный доступ к интерфейсу производится через ssh-туннель (т.е. необходим доступ к серверу по ssh)

### Клиент ssh

На стороне клиента настройка туннеля производится в файле .ssh/config в домашнем каталоге пользователя.
В блоке настроек сервера добавляются строки:

```
# Host your.consup.srv

  # Consul UI
  LocalForward 8141 127.0.1.2:8500

```

